from Crypto.Cipher import AES
from PIL import Image

key = [0x52, 0xfd, 0xfc, 0x7, 0x21, 0x82, 0x65, 0x4f, 0x16, 0x3f, 0x5f, 0xf, 0x9a, 0x62, 0x1d, 0x72, 0x95, 0x66, 0xc7, 0x4d, 0x10, 0x3, 0x7c, 0x4d, 0x7b, 0xbb, 0x4, 0x7, 0xd1, 0xe2, 0xc6, 0x49]
iv = [0x81, 0x85, 0x5a, 0xd8, 0x68, 0x1d, 0xd, 0x86, 0xd1, 0xe9, 0x1e, 0x0, 0x16, 0x79, 0x39, 0xcb]

cipher = AES.new(bytes(key), AES.MODE_CBC, bytes(iv))
cipher2 = AES.new(bytes(key), AES.MODE_CBC, bytes(iv))

im = Image.open('target.png', 'r')
width, height = im.size
pixel_values = list(im.getdata())
ct = []
for i in pixel_values:
	if(i!=(0, 0, 0, 0)):
		ct.append(i[0])
ct2 = []
for i in range(len(ct)):
	ct2.append(i^ct[i])

print(cipher.decrypt(cipher2.decrypt(bytes(ct2))))
# bi0sCTF{Th3_fl4gs_l0wk3y_3ncryp7i0n_b3li3s_i7s_f0rmid4bl3_c1ph3r}